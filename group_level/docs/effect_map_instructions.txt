#############################

IMPORTANT: this is just for quick & dirty reference for generating effect maps and was copied unformatted from this link: 
https://docs.google.com/document/d/1Srcph1qzZo0VzrrzlNqrFOePBrp28HE_WQvUsDTKL2k/edit#heading=h.haj1pdii45fk

#############################



1. Copy and rename effect size script for your study

Make a copy of  /mridata2/home2/smn33/scripts/effect_size/EXAMPLE_dataset_map_test_x1_x2__v2.m

Rename according to the following file naming convention (keep the “__v2” !): (dataset)_(act|fc)_(t|t2|r)_(var/group1)_(var/group2)__v2.m
        > Ex 1 (FC 2-ttest):     hcp_fc_t2_malerest_femalerest__v2.m
        > Ex 2 (FC correlation):  hcp_fc_r_rest_gF__v2.m
        > Ex 3 (activation ttest): hcp_act_t_emotion_rest__v2.m

                                                                                                                                                     (This should match your filename from Part I: Effect Map Instructions I)

2. Set paths and setup data loading for your study

MUST be specified: everything marked “USER-DEFINED”, including:
mean motion: dir, filename, and associated subject IDs filename
easiest if you create a single .txt file with a vector representing mean motion across the scan for each subject
subject IDs needed to match the motion and connectome data for each subject
    results: file prefix
    rename according to above file naming convention—remember to keep “__v2” ! :(dataset)_(act|fc)_(t|t2|r)_(var/group1)_(var/group2)__v2
    data loader: script paths and “load data” section
    replace with however you load your data

    Can optionally be specified (if for some reason you don’t want to use the defaults):
        scripts: if you don’t want to use them from my folder, can optionally be copied from /mridata2/home2/smn33/scripts/effect_size/helper_scripts
        atlas_tools (originally cloned from https://github.com/SNeuroble/atlas_tools)
        fast_regression
        results: directory
        useful if you want to test your script elsewhere before finally moving output to the training directory

        3. Fix data dimensions and triangle side if needed

        Check the following dimensions and transpose if needed:
        m (data) is n_subs x n_var 
        beh (outcome variable) is n_subs x 1
        if you’re doing a group contrast (i.e., 2-sample t-test), this should be a binary vector
        motion is n_subs x 1

        Important: Please check that each row of m was taken from the upper triangle of the original matrix consistent with Matlab indexing.
        For example, this will be the case if m is created and saved in Matlab as follows:
        triu_mask=logical(triu(ones(268),1)); % upper triangular mask
        m(this_subject,:) = mat(triu_mask); % vector extracted from mask
        Necessary for the pooling and summary functions to work correctly
        If this was previously not the case, don’t worry—please fix it here and note in the effect map spreadsheet under “add’l notes”

        4. Run the script to conduct the following analyses and save results:
        [ univariate | pooled ] x [ no motion correction | motion regression | motion threshold ]

        For testing or correcting output: if you need to run / re-run a single analysis, you can change pooling_params or motion_method_params accordingly

        Documentation notes
        The following functionality has been added to the new script:
    optional pooling by large-scale networks
    optional motion correction (none, regression, or threshold)
function for estimating all test-statistics as partial, semipartial, or full correlations (confound)
    As before, the new script saves test statistics, p-values, and sample sizes. However, the script now 1) estimates group contrasts using correlation (point-biserial r), and 2) changes the output filename based on pooling / motion correction strategy, resulting in 6 new files per study:
> corr: r, p, std_X, std_y, n (for continuous correlation or paired-sample), n1 (for 2-sample), n2 (for 2-sample)

    5. Copy script and .mat file to MRRC folder

    Script should contain: original data directory, how you loaded the data, commands you ran
    Helps us replicate and extend in the future
    Ask me (Stephanie) if you need help with any of this! It will be important for the power calculator we’re building over the next several years

    Destination (mounted on shred): /data_dustin/store3/training/effect_size/

                                     If you’re not on an MRRC computer, you can scp—example:
                                     scp /some_dir/hcp_fc_r_rest_gF.mat /some_dir/hcp_fc_r_rest_gF.m my_username@10.168.128.189:/data_dustin/store3/training/effect_size/

6. Mark that you’re done in Datasets (“Effect Maps” tab, “maps completed” columns)

    EXAMPLE SCRIPT - generic: /mridata2/home2/smn33/scripts/effect_size/EXAMPLE_dataset_map_test_x1_x2__v2.m

    EXAMPLE SCRIPT - HCP:
    /data_dustin/store3/training/effect_size/hcp_fc_r_rest_gf__v2.m


